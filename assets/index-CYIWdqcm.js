const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BCI5rEJW.js","assets/main-4lvyySLX.js","assets/events-BA9ctX3e.js"])))=>i.map(i=>d[i]);
import{p as u,W as c,K as o,q as w,t as d,_ as y,J as g,M,v as h,w as N,x as p,y as I,E as m,z as l}from"./main-4lvyySLX.js";const _="Trezor";class z extends u{constructor(a={}){var t;super(),this.name=_,this.url="https://trezor.io",this.icon="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGQ9Ik01NCAwYzI5LjgyNCAwIDU0IDI0LjE3NiA1NCA1NHMtMjQuMTc2IDU0LTU0IDU0UzAgODMuODI0IDAgNTQgMjQuMTc2IDAgNTQgMHoiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJNNzUuMjUgMzMuMzA1Qzc1LjI1IDIyLjIwNSA2NS42NjIgMTMgNTQgMTNjLTExLjY3MiAwLTIxLjI1OCA5LjIxMi0yMS4yNTggMjAuMzA1djYuNDlIMjR2NDYuNjgzTDUzLjk5IDEwMC41IDg0IDg2LjQ3NXYtNDYuNDdoLTguNzQ1bC0uMDA3LTYuNjk4LjAwMi0uMDAyem0tMzEuNjcgMGMwLTUuMjMyIDQuNTg1LTkuNDIgMTAuNDE4LTkuNDIgNS44MzUgMCAxMC40MTcgNC4xODggMTAuNDE3IDkuNDJ2Ni40OUg0My41OHYtNi40OXptMjguMzM1IDQ1LjYzN0w1My45OSA4Ny4zMmwtMTcuOTItOC4zNzJWNTAuODloMzUuODQ1djI4LjA1MnoiIGZpbGw9IiMxNzE3MTciLz48L2c+PGRlZnM+PGNsaXBQYXRoIGlkPSJhIj48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMCAwaDEwOHYxMDhIMHoiLz48L2NsaXBQYXRoPjwvZGVmcz48L3N2Zz4=",this.supportedTransactionVersions=new Set(["legacy",0]),this._readyState=typeof window>"u"||typeof document>"u"?c.Unsupported:c.Loadable,this._onDeviceEvent=i=>{i.type==="device-disconnect"&&this._disconnected()},this._disconnected=async()=>{const i=this._wallet;if(i){this._wallet=null,this._publicKey=null;try{i.off("DEVICE_EVENT",this._onDeviceEvent),i.dispose()}catch(s){this.emit("error",new o(s==null?void 0:s.message,s))}this.emit("error",new w),this.emit("disconnect")}},this._derivationPath=a.derivationPath||"m/44'/501'/0'/0'",this._wallet=null,this._connectUrl=(t=a.connectUrl)==null?void 0:t.replace(/\/*$/,"/"),this._connecting=!1,this._publicKey=null,this._appName=a.appName||"Wallet Adapter",this._email=a.email||"noreply@anza.xyz"}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){var a;try{if(this.connected||this.connecting)return;if(this._readyState!==c.Loadable)throw new d;this._connecting=!0;let t;try{const{default:e}=await y(async()=>{const{default:r}=await import("./index-BCI5rEJW.js").then(n=>n.i);return{default:r}},__vite__mapDeps([0,1,2]));t=e.default}catch(e){throw new g(e==null?void 0:e.message,e)}try{await t.init({manifest:{appName:this._appName,email:this._email,appUrl:window.location.href},lazyLoad:!0,...this._connectUrl?{connectSrc:this._connectUrl,iframeSrc:this._connectUrl}:{}})}catch(e){throw new M(e==null?void 0:e.message,e)}let i;try{i=await t.solanaGetPublicKey({path:this._derivationPath})}catch(e){throw new h(e==null?void 0:e.message,e)}if(!i.success)throw new h((a=i.payload)==null?void 0:a.error,i.payload);let s;try{s=new N(Buffer.from(i.payload.publicKey,"hex"))}catch(e){throw new p(e==null?void 0:e.message,e)}t.on("DEVICE_EVENT",this._onDeviceEvent),this._wallet=t,this._publicKey=s,this.emit("connect",s)}catch(t){throw this.emit("error",t),t}finally{this._connecting=!1}}async disconnect(){const a=this._wallet;if(a){this._wallet=null,this._publicKey=null;try{a.off("DEVICE_EVENT",this._onDeviceEvent),await a.dispose()}catch(t){this.emit("error",new o(t==null?void 0:t.message,t))}this.emit("disconnect")}}async signTransaction(a){var t;try{const i=this._wallet,s=this._publicKey;if(!i||!s)throw new I;const e=m(a)?a.message.serialize():a.serializeMessage();let r;try{r=await i.solanaSignTransaction({path:this._derivationPath,serializedTx:Buffer.from(e).toString("hex")})}catch(n){throw new l(n==null?void 0:n.message,n)}if(!r.success)throw new l((t=r.payload)==null?void 0:t.error,r.payload);try{const n=Buffer.from(r.payload.signature,"hex");a.addSignature(s,n)}catch(n){throw new l(n==null?void 0:n.message,n)}return a}catch(i){throw this.emit("error",i),i}}}export{z as TrezorWalletAdapter,_ as TrezorWalletName};
